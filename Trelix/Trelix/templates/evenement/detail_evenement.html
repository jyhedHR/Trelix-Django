{% extends "trelix/base.html" %} 
{% load static %}
{% block title %}{{ evenement.titre }} - Trelix{% endblock %} 

{% block content %} 
{% include 'trelix/header.html' %}

<!-- Messages -->
{% if messages %}
<div class="container mt-3">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
</div>
{% endif %}

<!-- Promo Section Start -->
<section class="promo-sec2">
   <div class="container">
      <div class="row">
         <div class="col-lg-7">
            <nav aria-label="breadcrumb mt-0">
               <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                  <li class="breadcrumb-item"><a href="{% url 'evenement:liste_evenements' %}">Events</a></li>
                  <li class="breadcrumb-item active" aria-current="page">{{ evenement.titre }}</li>
               </ol>
            </nav>
            <div class="course-intro">
               <h1>{{ evenement.titre }}</h1>
            </div>
         </div>
      </div>
   </div>
</section>
<!-- Promo Section End -->

<!-- Event Details Start -->
<section class="course-details-sec">
   <div class="container">
      <div class="row">
         <div class="col-lg-8">
            <article class="course-details pe-lg-4">
               <!-- Large format image -->
               <div class="event-hero-image mb-4">
                  {% if evenement.image %}
                     <img class="rounded-3 img-fluid w-100 event-main-image" src="{{ evenement.image.url }}" alt="{{ evenement.titre }}" style="max-height: 500px; object-fit: cover;">
                  {% else %}
                     <div class="bg-secondary rounded-3 d-flex align-items-center justify-content-center event-placeholder" style="height: 400px;">
                        <div class="text-center text-white">
                           <i class="feather-icon icon-calendar display-1"></i>
                           <p class="mt-2 mb-0">No image available</p>
                        </div>
                     </div>
                  {% endif %}
               </div>

               <!-- Event Tabs Start -->
               <div class="course-nav mt-5">
                  <nav id="navbar-example2" class="bg-white sticky-top">
                     <ul class="nav nav-pills">
                        <li class="nav-item">
                           <a class="nav-link active" href="#overview"><i class="feather-icon icon-bookmark"></i> Overview</a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="#details"><i class="feather-icon icon-info"></i> Details</a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="#location"><i class="feather-icon icon-tag text"></i> Description</a>
                        </li>
                        <li class="nav-item">
                           <a class="nav-link" href="#about"><i class="feather-icon icon-book"></i> About</a>
                        </li>
                     </ul>
                  </nav>
                  
                  <div data-bs-spy="scroll" data-bs-target="#navbar-example2" data-bs-offset="0"
                     class="scrollspy-example" tabindex="0">
                     
                     <!-- Overview Section -->
                     <div class="inner-sec" id="overview">
                        <h2 class="display-4 fw-bold">Event Overview</h2>
                        <p class="lead">Hackathons and training represent two complementary approaches to stimulate learning and innovation. Hackathons are collaborative events where participants, often from various fields, design creative solutions to concrete problems within a limited time. They promote teamwork, critical thinking, and the practical application of knowledge. On the other hand, training provides a structured framework to acquire or improve technical and professional skills. Together, these experiences help strengthen the spirit of innovation, employability, and adaptation to the demands of the digital world.</p>
                        
                        <div class="row mt-4">
                           <div class="col-md-6">
                              <div class="info-card bg-light p-3 rounded-3 h-100">
                                 <h5 class="display-5"><i class="feather-icon icon-calendar text-primary me-2"></i> Date and Time</h5>
                                 <p class="mb-1"><strong>Start:</strong> {{ evenement.date_debut|date:"d/m/Y" }}</p>
                                 <p class="mb-0"><strong>End:</strong> {{ evenement.date_fin|date:"d/m/Y" }}</p>
                                 <p class="mt-2 text-muted small">
                                    <i class="feather-icon icon-clock me-1"></i>
                                    Duration: 
                                    {% if evenement.date_debut.date == evenement.date_fin.date %}
                                       {{ evenement.date_debut|timesince:evenement.date_fin }}
                                    {% else %}
                                       Multiple days
                                    {% endif %}
                                 </p>
                              </div>
                           </div>
                           <div class="col-md-6">
                              <div class="info-card bg-light p-3 rounded-3 h-100">
                                 <h5 class="display-5"><i class="feather-icon icon-users text-primary me-2"></i> Participants</h5>
                                 <p class="mb-0"><strong>Maximum capacity:</strong> {{ evenement.capacite_max }} people</p>
                                 <p class="mt-2 text-muted small">
                                    <i class="feather-icon icon-user-check me-1"></i>
                                    {{ evenement.public_cible|default:"Open to all audiences" }}
                                 </p>
                              </div>
                           </div>
                        </div>
                     </div>
                     
                     <!-- Details Section -->
                     <div class="inner-sec" id="details">
                        <h2 class="display-4 fw-bold">Event Details</h2>
                        
                        <div class="event-details-grid">
                           <div class="detail-item">
                              <i class="feather-icon icon-tag"></i>
                              <div>
                                 <strong>Event Type</strong>
                                 <p>{{ evenement.get_type_display }}</p>
                              </div>
                           </div>
                           
                           <div class="detail-item">
                              <i class="feather-icon icon-target"></i>
                              <div>
                                 <strong>Target Audience</strong>
                                 <p>{{ evenement.public_cible|default:"All audiences" }}</p>
                              </div>
                           </div>
                           
                           <div class="detail-item">
                              <i class="feather-icon icon-dollar-sign"></i>
                              <div>
                                 <strong>Price</strong>
                                 <p>
                                    {% if evenement.prix %}
                                       {{ evenement.prix }} â‚¬
                                    {% else %}
                                       <span class="text-success">Free</span>
                                    {% endif %}
                                 </p>
                              </div>
                           </div>
                           
                           <div class="detail-item">
                              <i class="feather-icon icon-award"></i>
                              <div>
                                 <strong>Certification</strong>
                                 <p>{{ evenement.certification|default:"Participation certificate" }}</p>
                              </div>
                           </div>
                        </div>

                        <!-- Detailed description -->
                        {% if evenement.description_complete %}
                        <div class="mt-4">
                           <h4 class="display-5 fw-bold">Complete Description</h4>
                           <div class="bg-light p-4 rounded-3">
                              {{ evenement.description_complete|linebreaks }}
                           </div>
                        </div>
                        {% endif %}
                     </div>
                     
                     <!-- Location Section -->
                     <div class="inner-sec" id="location">
                        <h2 class="display-4 fw-bold">Description</h2>
                        <div class="location-info">
                           <div class="d-flex align-items-start mb-4">
                              <div class="flex-grow-1">
                                 <p class="fs-5 mb-1"><strong>{{ evenement.description }}</strong></p>
                                 {% if evenement.adresse %}
                                    <p class="text-muted mb-3">{{ evenement.adresse }}</p>
                                 {% endif %}
                                 
                                 <!-- Venue description -->
                                 {% if evenement.description_lieu %}
                                    <div class="bg-light p-3 rounded-2 mt-2">
                                       <h6 class="fw-bold mb-2">About the venue:</h6>
                                       <p class="mb-0">{{ evenement.description_lieu }}</p>
                                    </div>
                                 {% endif %}
                              </div>
                           </div>
                           
                           {% if evenement.lien_visio %}
                           <div class="d-flex align-items-start mt-4 pt-3 border-top">
                              <i class="feather-icon icon-video text-primary me-3 mt-1"></i>
                              <div>
                                 <h5 class="display-5 mb-2">Online Participation</h5>
                                 <p class="mb-3">This event is also accessible online via our video conferencing platform.</p>
                                 <a href="{{ evenement.lien_visio }}" class="btn btn-primary btn-sm" target="_blank">
                                    <i class="feather-icon icon-video me-1"></i>Join video conference
                                 </a>
                              </div>
                           </div>
                           {% endif %}
                        </div>
                     </div>

                     <!-- About Section -->
                     <div class="inner-sec" id="about">
                        <h2 class="display-4 fw-bold">About {{ evenement.get_type_display }}s</h2>
                        
                        {% if evenement.type == 'hackathon' %}
                        <div class="about-content">
                           <h4 class="display-5 text-primary">What is a Hackathon?</h4>
                           <p>A hackathon is a collaborative event where developers, designers, entrepreneurs, and experts come together to work intensively on innovative projects. For 24 to 48 hours, participants form teams and create functional prototypes to solve specific challenges.</p>
                           
                           <h5 class="mt-4">Benefits of a Hackathon:</h5>
                           <ul class="benefits-list">
                              <li><i class="feather-icon icon-zap text-warning me-2"></i><strong>Rapid innovation</strong> - Accelerated prototyping</li>
                              <li><i class="feather-icon icon-award text-success me-2"></i><strong>Networking</strong> - Meet passionate people</li>
                              <li><i class="feather-icon icon-award text-success me-2"></i><strong>Learning</strong> - New technologies</li>
                              <li><i class="feather-icon icon-briefcase text-primary me-2"></i><strong>Opportunities</strong> - Talent discovery</li>
                           </ul>
                        </div>
                        
                        {% elif evenement.type == 'workshop' %}
                        <div class="about-content">
                           <h4 class="display-5 text-primary">Practical Workshops</h4>
                           <p>Our workshops are designed to provide a practical and immersive learning experience. Unlike theoretical training, our workshops emphasize the immediate application of taught concepts.</p>
                           
                           <h5 class="mt-4">What you will acquire:</h5>
                           <ul class="benefits-list">
                              <li><i class="feather-icon icon-settings text-warning me-2"></i><strong>Practical skills</strong> - Direct application</li>
                              <li><i class="feather-icon icon-help-circle text-info me-2"></i><strong>Expert support</strong> - Personalized guidance</li>
                              <li><i class="feather-icon icon-file-text text-success me-2"></i><strong>Resources</strong> - Complete documentation</li>
                              <li><i class="feather-icon icon-star text-primary me-2"></i><strong>Concrete project</strong> - Mini-project realization</li>
                           </ul>
                        </div>
                        
                        {% elif evenement.type == 'conference' %}
                        <div class="about-content">
                           <h4 class="display-5 text-primary">Educational Conferences</h4>
                           <p>Our conferences bring together experts and thought leaders to share the latest trends, research, and innovations in the field of education and technology.</p>
                           
                           <h5 class="mt-4">On the program:</h5>
                           <ul class="benefits-list">
                              <li><i class="feather-icon icon-trending-up text-warning me-2"></i><strong>Current trends</strong> - Technological watch</li>
                              <li><i class="feather-icon icon-eye text-info me-2"></i><strong>Strategic vision</strong> - Future perspectives</li>
                              <li><i class="feather-icon icon-share-2 text-success me-2"></i><strong>Expertise sharing</strong> - Experience feedback</li>
                              <li><i class="feather-icon icon-globe text-primary me-2"></i><strong>Professional network</strong> - Enriching exchanges</li>
                           </ul>
                        </div>
                        
                        {% else %}
                        <div class="about-content">
                           <h4 class="display-5 text-primary">Continuing Education & E-Learning</h4>
                           <p>In a constantly evolving world, continuing education is essential to remain competitive. Our educational events combine pedagogical expertise and technological innovation to offer transformative learning experiences.</p>
                           
                           <h5 class="mt-4">Our approach:</h5>
                           <ul class="benefits-list">
                              <li><i class="feather-icon icon-book-open text-warning me-2"></i><strong>Active pedagogy</strong> - Learning by doing</li>
                              <li><i class="feather-icon icon-cast text-info me-2"></i><strong>Innovative technology</strong> - Modern tools</li>
                              <li><i class="feather-icon icon-user-check text-success me-2"></i><strong>Personalization</strong> - Adapted to your needs</li>
                              <li><i class="feather-icon icon-bar-chart-2 text-primary me-2"></i><strong>Progress tracking</strong> - Results measurement</li>
                           </ul>
                           
                           <div class="mt-4 p-3 bg-light rounded-2">
                              <h6 class="fw-bold">The future of education is collaborative and digital</h6>
                              <p class="mb-0">We believe in accessible, engaging, and transformative education. Join our community of passionate learners and participate in the digital education revolution.</p>
                           </div>
                        </div>
                        {% endif %}
                     </div>
                  </div>
               </div>
            </article>
         </div>
         
         <!-- Sidebar -->
         <div class="col-lg-4">
            <aside class="sidebar sticky-top widget-top">
               <div class="widget price-widget bg-white border p-3 rounded-3">
                  <div class="course-preview mb-3">
                     {% if evenement.image %}
                        <img src="{{ evenement.image.url }}" alt="{{ evenement.titre }}" class="img-fluid rounded-2 w-100" style="height: 200px; object-fit: cover;">
                     {% else %}
                        <div class="bg-secondary rounded-2 d-flex align-items-center justify-content-center" style="height: 200px;">
                           <div class="text-center text-white">
                              <i class="feather-icon icon-calendar display-4"></i>
                              <p class="mt-2 mb-0">No image</p>
                           </div>
                        </div>
                     {% endif %}
                  </div>
                  
                  <div class="d-flex justify-content-between align-items-center">
                     <h3 class="display-4">
                        {% if evenement.prix %}
                           {{ evenement.prix }} â‚¬
                      
                        {% endif %}
                     </h3>
                     {% if evenement.date_debut > now %}
                        <span class="badge bg-success"><i class="feather-icon icon-clock me-1"></i>Upcoming</span>
                     {% elif evenement.date_fin < now %}
                        <span class="badge bg-secondary"><i class="feather-icon icon-check me-1"></i>Completed</span>
                    
                     {% endif %}
                  </div>
                  
                  <!-- MODIFIED PARTICIPATION SECTION -->
                  <div class="btn-cta mt-4">
                     {% if deja_participe %}
                        <button class="btn btn-success rounded-2 w-100" disabled>
                           <i class="feather-icon icon-check me-1"></i>Already participating
                        </button>
                        <form method="post" action="{% url 'participation:annuler_participation' evenement.id %}" class="mt-2">
                           {% csrf_token %}
                           <button type="submit" class="btn btn-outline-danger rounded-2 w-100" 
                                   onclick="return confirm('Are you sure you want to cancel your participation?')">
                               <i class="feather-icon icon-x me-1"></i>Cancel participation
                           </button>
                        </form>
                     {% else %}
                        {% if evenement.date_debut > now %}
                           <a href="{% url 'participation:participer_evenement' evenement.id %}" class="btn btn-primary rounded-2 w-100">
                               <i class="feather-icon icon-user-plus me-1"></i>Participate
                           </a>
                        {% elif evenement.date_fin < now %}
                           <button class="btn btn-secondary rounded-2 w-100" disabled>
                               <i class="feather-icon icon-calendar me-1"></i>Event completed
                           </button>
                        {% else %}
                           <a href="{% url 'participation:participer_evenement' evenement.id %}" class="btn btn-primary rounded-2 w-100">
                               <i class="feather-icon icon-play me-1"></i>Participate
                           </a>
                        {% endif %}
                     {% endif %}
                     
                     <!-- Link to my participations -->
                     {% if user.is_authenticated %}
                     <div class="text-center mt-3">
                        <a href="{% url 'participation:mes_participations' %}" class="text-primary small">
                            <i class="feather-icon icon-list me-1"></i>View my participations
                        </a>
                     </div>
                     {% endif %}
                  </div>
                  
                  <div class="price-widget-inner mt-4">
                     <ul>
                        <li><i class="feather-icon icon-calendar text-primary"></i>Start date <span>{{ evenement.date_debut|date:"d/m/Y" }}</span></li>
                        <li><i class="feather-icon icon-calendar text-primary"></i>End date <span>{{ evenement.date_fin|date:"d/m/Y" }}</span></li>
                        <li><i class="feather-icon icon-map-pin text-primary"></i>Location <span>{{ evenement.lieu }}</span></li>
                        <li><i class="feather-icon icon-users text-primary"></i>Capacity <span>{{ evenement.capacite_max }} spots</span></li>
                        <li><i class="feather-icon icon-tag text-primary"></i>Type <span>{{ evenement.get_type_display }}</span></li>
                        <li><i class="feather-icon icon-dollar-sign text-primary"></i>Price <span>{{ evenement.prix|default:"Free" }}</span></li>
                     </ul>
                  </div>
                  
                  <div class="card bg-shade p-3 text-center mt-4">
                     <h6>Share this event</h6>
                     <div class="social-share white my-3 border-bottom pb-3">
                        <a href="#"><i class="feather-icon icon-facebook"></i></a>
                        <a href="#"><i class="feather-icon icon-linkedin"></i></a>
                        <a href="#"><i class="feather-icon icon-twitter"></i></a>
                        <a href="#"><i class="feather-icon icon-instagram"></i></a>
                     </div>
                     
                     {% if user.is_staff %}
                     <div class="admin-actions mt-3">
                        <a href="{% url 'admin:evenement_evenement_change' evenement.id %}" class="btn btn-warning btn-sm w-100">
                           <i class="feather-icon icon-edit me-1"></i>Edit event
                        </a>
                     </div>
                     {% endif %}
                  </div>
               </div>
            </aside>
         </div>
      </div>
   </div>
</section>
<!-- Event Details End -->

<!-- Newsletter Section Start -->
<section class="newsletter bg-primary">
   <div class="container">
      <div class="row align-items-center">
         <div class="col-lg-8">
            <span class="badge-lg bg-white text-primary rounded-5">Stay Informed</span>
            <h2 class="display-2 fw-bold text-info">Subscribe to our <span class="color-info">Newsletter</span></h2>
         </div>
         <div class="col-lg-4">
            <div class="newsletter-form">
               <form action="#">
                  <input class="form-control rounded-5 bg-info" type="email" placeholder="Email Address">
                  <button class="btn btn-secondary w-100 rounded-5 mt-4">Subscribe</button>
               </form>
            </div>
         </div>
      </div>
   </div>
</section>
<!-- Newsletter Section End -->

<style>
.promo-sec2 {
   background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
   padding: 80px 0 60px;
   color: white;
}

.course-intro h1 {
   font-size: 2.5rem;
   font-weight: 700;
   margin-bottom: 1rem;
}

.course-intro .lead {
   font-size: 1.2rem;
   opacity: 0.9;
   margin-bottom: 1.5rem;
}

/* Main image in large format */
.event-hero-image {
   position: relative;
   overflow: hidden;
}

.event-main-image {
   transition: transform 0.3s ease;
}

.event-hero-image:hover .event-main-image {
   transform: scale(1.02);
}

.event-details-grid {
   display: grid;
   grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
   gap: 1.5rem;
   margin-top: 2rem;
}

.detail-item {
   display: flex;
   align-items: flex-start;
   gap: 1rem;
   padding: 1.5rem;
   background: #f8f9fa;
   border-radius: 12px;
   border-left: 4px solid #0d6efd;
   transition: transform 0.2s ease;
}

.detail-item:hover {
   transform: translateY(-2px);
}

.detail-item i {
   font-size: 1.5rem;
   color: #0d6efd;
   margin-top: 0.25rem;
}

.detail-item strong {
   display: block;
   margin-bottom: 0.5rem;
   color: #2c3e50;
}

.detail-item p {
   margin: 0;
   color: #6c757d;
}

.info-card {
   border-left: 4px solid #0d6efd;
   transition: all 0.3s ease;
}

.info-card:hover {
   box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.location-info {
   background: #f8f9fa;
   padding: 2rem;
   border-radius: 12px;
}

.about-content {
   line-height: 1.7;
}

.benefits-list {
   list-style: none;
   padding: 0;
}

.benefits-list li {
   padding: 0.5rem 0;
   border-bottom: 1px solid #e9ecef;
}

.benefits-list li:last-child {
   border-bottom: none;
}

.benefits-list i {
   width: 20px;
}

.nav-pills .nav-link {
   color: #6c757d;
   font-weight: 500;
   padding: 1rem 1.5rem;
   transition: all 0.3s ease;
}

.nav-pills .nav-link.active {
   background: #0d6efd;
   color: white;
}

.nav-pills .nav-link i {
   margin-right: 0.5rem;
}

.price-widget-inner ul {
   list-style: none;
   padding: 0;
   margin: 0;
}

.price-widget-inner li {
   display: flex;
   justify-content: space-between;
   align-items: center;
   padding: 0.75rem 0;
   border-bottom: 1px solid #e9ecef;
}

.price-widget-inner li:last-child {
   border-bottom: none;
}

.price-widget-inner li i {
   color: #0d6efd;
   margin-right: 0.5rem;
}

.social-share a {
   display: inline-flex;
   align-items: center;
   justify-content: center;
   width: 40px;
   height: 40px;
   background: #0d6efd;
   color: white;
   border-radius: 50%;
   margin: 0 0.25rem;
   text-decoration: none;
   transition: all 0.3s ease;
}

.social-share a:hover {
   background: #0b5ed7;
   transform: translateY(-2px);
}

/* Responsive */
@media (max-width: 768px) {
   .course-intro h1 {
      font-size: 2rem;
   }
   
   .event-details-grid {
      grid-template-columns: 1fr;
   }
   
   .detail-item {
      padding: 1rem;
   }
   
   .course-details-meta {
      flex-direction: column;
      gap: 1rem;
      align-items: start;
   }
   
   .event-main-image {
      max-height: 300px;
   }
}
</style>

{% include 'trelix/footer.html' %} 
{% endblock %}